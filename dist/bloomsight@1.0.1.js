(()=>{"use strict";var e={18:(e,s,t)=>{function i(e){return!(null==e)}function o(e){return i(e)&&e.length>0}function r(e){return!o(e)}function n(e){return i(e)&&(""===e.trim()||0===e.trim().length)}function d(e,s){return o(e)&&e.length===s}function c(e,s,t=!1){return!(!i(e)||!i(s))&&(t?e.toLowerCase()===s.toLowerCase():e===s)}function l(e){return JSON.parse(JSON.stringify(e))}function a(e){return 0===Object.keys(e).length}t.r(s),t.d(s,{areStringsEqual:()=>c,arrayDeepCopy:()=>l,arrayEmpty:()=>r,arrayLength:()=>d,arrayNotEmpty:()=>o,isEmptyObject:()=>a,isEmptyString:()=>n,valueExists:()=>i})},31:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DataEventTransmissionService=void 0;const i=t(932),o=t(795),r=t(225);class n extends i.TransmissionService{trigger(e,s,t,i,n,d,c,l,a,h){let u={property:window.propertyToken,dataEventToken:e,eventLogData:s,userId:t,newUser:i,newSession:n,returningUser:!i,ipAddress:d,countryCode:c,osName:l,deviceType:a,browserName:h};window.isDevelopmentMode&&console.log("Data event logged",u),this.executePostPayload(o.RequestMapperService.ADD_DATA_EVENT,u,r.ConstantService.REQUEST_HEADERS,(()=>{}),(e=>{}),(e=>{}),(()=>{}),(()=>{}))}}s.DataEventTransmissionService=n},550:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SimpleEventTransmissionService=void 0;const i=t(932),o=t(795),r=t(225);class n extends i.TransmissionService{trigger(e,s,t,i,n,d,c,l,a){let h={property:window.propertyToken,simpleEventToken:e,userId:s,newUser:t,newSession:i,returningUser:!t,ipAddress:n,countryCode:d,osName:c,deviceType:l,browserName:a};window.isDevelopmentMode&&console.log("Simple event logged",h),this.executePostPayload(o.RequestMapperService.ADD_SIMPLE_EVENT,h,r.ConstantService.REQUEST_HEADERS,(()=>{}),(e=>{}),(e=>{}),(()=>{}),(()=>{}))}}s.SimpleEventTransmissionService=n},932:(e,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TransmissionService=void 0,s.TransmissionService=class{executePostPayload(e,s,t,i,o,r,n,d){i(),fetch(e,{method:"POST",headers:t,body:JSON.stringify(s)}).then((e=>e.json())).then((e=>{o(e),e.success&&r(e)})).catch((e=>{console.log("catch",e),n(e.toString())})).finally((()=>d()))}}},273:(e,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ConfigurationService=void 0;class t{constructor(){}}s.ConfigurationService=t,t.PRODUCTION=!1,t.SECURE_CONNECT=t.PRODUCTION,t.PROTOCOL=t.SECURE_CONNECT?"https://":"http://",t.DOMAIN_PRODUCTION="api.bloomsight.io",t.DOMAIN_LOCALHOST="localhost",t.API_PREFIX="/api/v1",t.DOMAIN=t.PRODUCTION?t.DOMAIN_PRODUCTION:t.DOMAIN_LOCALHOST,t.SERVER_PORT=t.PRODUCTION?"":":3000",t.API_ENDPOINT=t.PROTOCOL+t.DOMAIN+t.SERVER_PORT+t.API_PREFIX},225:(e,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ConstantService=void 0;class t{constructor(){}}s.ConstantService=t,t.PROPERTY_TOKEN_CONFIG="PROPERTY_ID",t.REQUEST_HEADERS=new Headers({"Content-Type":"application/json"})},13:(e,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.LocalStorageService=void 0,s.LocalStorageService=class{constructor(){this._sessionTimeKey="sessionEnd",this._userKey="userId",this._eventListKey="eventList"}store(e,s){localStorage.setItem(e,s)}retrieve(e){const s=localStorage.getItem(e);return null===s?"":s}storeEventList(e){this.store(this._eventListKey,JSON.stringify(e))}retrieveEventList(){return JSON.parse(this.retrieve(this._eventListKey))}}},826:(e,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PlatformService=void 0,s.PlatformService=class{constructor(){this.browser="",this.browserVersion="",this.os="",this.device="",this._userAgent="",this._userAgent=window.navigator.userAgent}init(){this.detectBrowser(),this.detectBrowserVersion(),this.detectOS(),this.detectDevice(),window.isDevelopmentMode&&(console.log(`Browser detected: ${this.browser} (v${this.browserVersion})`),console.log(`OS detected:  ${this.os}`),console.log(`Device detected:  ${this.device}`))}detectBrowser(){let e=0,s=0;-1!==this._userAgent.indexOf("Opera")?this.browser="Opera":-1!==this._userAgent.indexOf("OPR")?this.browser="Opera Next":-1!==this._userAgent.indexOf("Edge")?this.browser="Microsoft Edge (Legacy)":-1!==this._userAgent.indexOf("Edg")?this.browser="Microsoft Edge (Chromium)":-1!==this._userAgent.indexOf("Chrome")?this.browser="Google Chrome":-1!==this._userAgent.indexOf("Safari")?this.browser="Apple Safari":-1!==this._userAgent.indexOf("Firefox")?this.browser="Mozilla Firefox":-1!==this._userAgent.indexOf("MSIE")||-1!==this._userAgent.indexOf("Trident")?this.browser="Microsoft Internet Explorer":(e=this._userAgent.lastIndexOf(" ")+1)<(s=this._userAgent.lastIndexOf("/"))?this.browser=this._userAgent.substring(e,s):this.browser="Unknown"}detectBrowserVersion(){const e=this._userAgent.match(/(Chrome|Firefox|Safari|Edge|IE|Opera|Trident)[\/\s](\d+(\.\d+)*)/);this.browserVersion=e?e[2]:"Unknown"}detectOS(){-1!==this._userAgent.indexOf("Windows")?this.os="Windows":-1!==this._userAgent.indexOf("Mac OS")?this.os="MacOS":-1!==this._userAgent.indexOf("Linux")?this.os="Linux":-1!==this._userAgent.indexOf("Android")?this.os="Android":-1!==this._userAgent.indexOf("iOS")?this.os="iOS":this.os="Unknown"}detectDevice(){/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(this._userAgent)?this.device="Tablet":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|webOS)/i.test(this._userAgent)?this.device="Mobile":this.device="Desktop"}}},795:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.RequestMapperService=void 0;const i=t(273);class o{constructor(){}}s.RequestMapperService=o,o.ADD_SIMPLE_EVENT=i.ConfigurationService.API_ENDPOINT+"/simple-event-data/add",o.ADD_DATA_EVENT=i.ConfigurationService.API_ENDPOINT+"/data-event-data/add"},447:(e,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SessionStorageService=void 0,s.SessionStorageService=class{store(e,s){sessionStorage.setItem(e,s)}retrieve(e){const s=sessionStorage.getItem(e);return null===s?"":s}}},880:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SessionService=void 0;const i=t(447),o=t(13),r=t(530);class n{constructor(){this._ipKey="h#6MNsN!4*z@E4",this._countryKey="Ytb^8HRfD&k3Lx",this._sessionExpiryTimeKey="WkDw3aZ#HD6^Ar",this._sessionExpiryTimeInMilliseconds=0,this._sessionCheckInterval=0,this.isNewSession=!0,this._localStore=new o.LocalStorageService,this._sessionStore=new i.SessionStorageService,this.checkSessionActivity=()=>{const e=Date.now();window.isDevelopmentMode&&console.log(`session will be active for:  ${r.UtilityService.convertSecondsToMinuteAndSeconds(Math.floor((this._sessionExpiryTimeInMilliseconds-e)/1e3))}`),e>this._sessionExpiryTimeInMilliseconds&&this.resetSession()}}init(){this.setIPAndCountry(),this.startSession(),window.isDevelopmentMode&&console.log("New session started")}setIPAndCountry(){fetch("https://jsonip.com",{mode:"cors"}).then((e=>e.json())).then((e=>{this.storeIP(e.ip),this.storeCountryCode(e.country),window.isDevelopmentMode&&(console.log(`IP detected: ${this._sessionStore.retrieve(this._ipKey)}`),console.log(`Country detected: ${this._sessionStore.retrieve(this._countryKey)}`))})).catch((e=>{window.isDevelopmentMode&&console.error("Unable to get IP",e)}))}startSession(){0!=this._sessionCheckInterval&&window.clearInterval(this._sessionCheckInterval),this._sessionExpiryTimeInMilliseconds=Date.now()+60*n._sessionDurationInMinutes*1e3,this._localStore.store(this._sessionExpiryTimeKey,this._sessionExpiryTimeInMilliseconds.toString()),this._sessionCheckInterval=window.setInterval(this.checkSessionActivity,6e4)}extendSession(){window.isDevelopmentMode&&console.log("Existing session extended"),this.isNewSession=!1,this.startSession()}resetSession(){window.isDevelopmentMode&&console.log("New session started"),this.isNewSession=!0,this.startSession()}storeIP(e){this._sessionStore.store(this._ipKey,e)}retrieveIP(){return this._sessionStore.retrieve(this._ipKey)}storeCountryCode(e){this._sessionStore.store(this._countryKey,e)}retrieveCountryCode(){return this._sessionStore.retrieve(this._countryKey)}retrieveSessionExpiryTime(){return 0!=this._sessionExpiryTimeInMilliseconds||(this._sessionExpiryTimeInMilliseconds=+this._localStore.retrieve(this._sessionExpiryTimeKey)),this._sessionExpiryTimeInMilliseconds}}s.SessionService=n,n._sessionDurationInMinutes=30},768:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UserService=void 0;const i=t(13),o=t(18),r=t(530);class n{constructor(){this._userId=null,this._userKey="EUJLo$Wu$6iH#s",this.isNewUser=!1,this._localStore=new i.LocalStorageService}init(){this.isValidUserExists()?window.isDevelopmentMode&&console.log(`Existing user retrieved: ${this._userId}`):this.generateNewUser()}isValidUserExists(){return this._userId=this.retrieveUser(),!(0,o.isEmptyString)(this._userId)}generateNewUser(){this._userId=r.UtilityService.getUniqueId(),this.isNewUser=!0,this.storeUser(this._userId),window.isDevelopmentMode&&console.log(`New user generated: ${this._userId}`)}storeUser(e){this._localStore.store(this._userKey,e)}retrieveUser(){return null!=this._userId||(this._userId=this._localStore.retrieve(this._userKey)),this._userId}}s.UserService=n,n._userTenureInDays=45},530:(e,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UtilityService=void 0,s.UtilityService=class{static getUniqueId(){return(Date.now()+Math.random()).toString(36)}static convertSecondsToMinuteAndSeconds(e){return e<0?"0 seconds":`${Math.floor(e/60)} minute(s) and ${e%60} second(s)`}}}},s={};function t(i){var o=s[i];if(void 0!==o)return o.exports;var r=s[i]={exports:{}};return e[i](r,r.exports,t),r.exports}t.d=(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},t.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=t(880),s=t(768),i=t(826),o=t(31),r=t(550),n=t(225);let d=Date.now();const c=new i.PlatformService,l=new e.SessionService,a=new s.UserService,h=new r.SimpleEventTransmissionService,u=new o.DataEventTransmissionService;function v(){d+6e4-Date.now()<0&&(l.extendSession(),d=Date.now())}c.init(),l.init(),a.init(),window.bloomsightConfig=(e,s)=>{e==n.ConstantService.PROPERTY_TOKEN_CONFIG&&(window.propertyToken=s,window.isDevelopmentMode&&console.log(`Property ID: ${window.propertyToken}`))},window.addEventListener("click",v),window.addEventListener("scroll",v),window.addEventListener("wheel",v),window.addEventListener("mousemove",v),window.addEventListener("keydown",v),window.logBloomsightSimpleEvent=e=>{h.trigger(e,a.retrieveUser(),a.isNewUser,l.isNewSession,l.retrieveIP(),l.retrieveCountryCode(),c.os,c.device,c.browser)},window.logBloomsightDataEvent=(e,s)=>{u.trigger(e,s,a.retrieveUser(),a.isNewUser,l.isNewSession,l.retrieveIP(),l.retrieveCountryCode(),c.os,c.device,c.browser)}})()})();